(function(e){e.theChart="";e.containerId="";e.theme="";e.dimensions="";e.title="";e.dateFormat="";e.defaultOperator="=";e.generator="";e.fn.amFilter=function(t){var n=e.extend({chartObject:"",debug:false,filterContainer:this.selector,theme:"",dimensions:[],title:"",dateFormat:"",generator:""},t);e.theChart=n.chartObject;e.filterContainer=n.filterContainer;e.theme=n.theme;e.dimensions=n.dimensions;e.title=n.title;e.dateFormat=n.dateFormat;e.generator=n.generator;e("head").append('<link rel="stylesheet" type="text/css" href="'+e.theme+'">');if(!e.theChart){if(n.debug===true){console.debug("Missing chartObject property!")}return false}else{e.theChart.addListener("rendered",e.buildFilter)}};e.buildActionButton=function(){e.button='<input type="button" name="clear" value="Clear filter" class="jqaf-action-button">&nbsp;<input type="submit" name="apply" value="Apply filter" class="jqaf-action-button">';return e.button};e.buildGrid=function(){e.row="";e.value="";e.dimension="";for(e.item in e.dimensions){if(typeof e.dimensions[e.item].operator!=="undefined"){e.operator='<input type="hidden" name="operator[]" value="'+e.dimensions[e.item].operator+'">'}else{e.operator='<input type="hidden" name="operator[]" value="'+e.defaultOperator+'">'}e.dimension='<input type="hidden" name="dimension[]" value="'+e.dimensions[e.item].dimension+'">';if(e.dimensions[e.item].type=="date"){e.value='<input type="text" name="value[]" class="date-field jqaf-field">'}else{e.value='<input type="text" name="value[]" class="jqaf-field">'}e.row+='<div class="jqaf-tr"><div class="jqaf-tc">'+e.dimensions[e.item].name+'</div><div class="jqaf-tc">'+e.dimension+e.operator+e.value+"</div></div>"}return e.row};e.buildHTML=function(){var t=String.fromCharCode(65+Math.floor(Math.random()*26));var n=t+Date.now();var r='<form method="post" id="jqaf-'+n+'" action="'+e.generator+'" target="_blank" onSubmit="return $.sendRequest(this.id)">';r+='<input type="hidden" name="filter" value="true">';r+='<div class="jqaf"><div class="jqaf-title"><div class="jqaf-tc">'+e.title+'</div></div><div class="jqaf-table-container"><div class="jqaf-table"><div class="jqaf-th"><div class="jqaf-tc">Dimension</div><div class="jqaf-tc">Selected value</div></div>'+e.buildGrid()+"</div>"+e.buildActionButton()+"</div></div>";r+="</form>";return r};e.sendRequest=function(t){e.ajax({type:"POST",url:e("#"+t).attr("action"),data:e("#"+t).serialize(),success:function(t){e.theChart.dataProvider=t;e.theChart.validateData()}});return false};e.buildFilter=function(){e.buildGrid();e.containerId=e.theChart.div.id;e(e.filterContainer).html(e.buildHTML());e(".date-field").datepicker({dateFormat:e.dateFormat})}})(jQuery)